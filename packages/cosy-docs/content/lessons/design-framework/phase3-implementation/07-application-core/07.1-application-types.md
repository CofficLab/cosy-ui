# 步骤 07.1：应用程序类型定义

## 目标
定义应用程序核心所需的所有类型接口，为后续实现提供类型安全保证。

## 任务清单
- [ ] 定义应用程序接口
- [ ] 定义配置类型
- [ ] 定义生命周期钩子类型
- [ ] 定义启动器选项类型

## 执行步骤

### 1. 更新类型定义

**更新文件**: `src/types/index.ts`

```typescript
// 应用程序相关类型
export interface ApplicationInterface {
  // 生命周期
  boot(): Promise<void>
  start(port?: number): Promise<void>
  stop(): Promise<void>
  
  // 配置
  configure(callback: (app: ApplicationInterface) => void): ApplicationInterface
  config(key: string, value?: any): any
  
  // 服务管理
  register(provider: ServiceProvider): ApplicationInterface
  resolve<T>(token: string | symbol): T
  singleton<T>(token: string | symbol, implementation: Constructor<T>): ApplicationInterface
  bind<T>(token: string | symbol, implementation: Constructor<T>): ApplicationInterface
  
  // 路由
  get(path: string, handler: RouteHandler): RouteInterface
  post(path: string, handler: RouteHandler): RouteInterface
  put(path: string, handler: RouteHandler): RouteInterface
  patch(path: string, handler: RouteHandler): RouteInterface
  delete(path: string, handler: RouteHandler): RouteInterface
  group(prefix: string | RouteGroupOptions, callback: (router: RouterInterface) => void): void
  
  // 中间件
  use(middleware: MiddlewareHandler): ApplicationInterface
  useGlobal(middleware: MiddlewareHandler): ApplicationInterface
  
  // 请求处理
  handle(request: RequestInterface): Promise<ResponseInterface>
  handleHttp(req: any, res: any): Promise<void>
  
  // 状态
  isRunning(): boolean
  getPort(): number | undefined
}

export interface ApplicationConfig {
  name?: string
  debug?: boolean
  port?: number
  host?: string
  timezone?: string
  locale?: string
  providers?: Constructor<ServiceProvider>[]
  middleware?: MiddlewareHandler[]
}

export interface ApplicationLifecycleHooks {
  beforeBoot?: () => Awaitable<void>
  afterBoot?: () => Awaitable<void>
  beforeStart?: () => Awaitable<void>
  afterStart?: () => Awaitable<void>
  beforeStop?: () => Awaitable<void>
  afterStop?: () => Awaitable<void>
}

export interface BootstrapOptions {
  config?: ApplicationConfig
  configPath?: string
  providers?: Constructor<ServiceProvider>[]
  hooks?: ApplicationLifecycleHooks
}
```

## 完成标志
- [ ] 所有必要的类型接口已定义
- [ ] 类型定义完整且清晰
- [ ] TypeScript 类型检查无错误
- [ ] 接口文档注释完整

## 下一步
完成此步骤后，继续执行 `07.2-application-core.md`。 
