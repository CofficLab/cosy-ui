# 步骤 01.2：基础文件设置

## 目标
创建框架所需的基础类型定义和入口文件。

## 任务清单
- [ ] 创建基础类型定义
- [ ] 创建主入口文件
- [ ] 创建临时模块文件

## 执行步骤

### 1. 创建基础类型定义

**文件**: `src/types/index.ts`

```typescript
// 基础类型定义
export type Constructor<T = {}> = new (...args: any[]) => T

// 装饰器类型
export interface ClassDecorator {
  <TFunction extends Function>(target: TFunction): TFunction | void
}

export interface MethodDecorator {
  <T>(target: any, propertyKey: string | symbol, descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T> | void
}

export interface ParameterDecorator {
  (target: any, propertyKey: string | symbol | undefined, parameterIndex: number): void
}

// 服务容器类型
export interface ServiceBinding<T = any> {
  token: string | symbol
  implementation: Constructor<T>
  singleton: boolean
  instance?: T
}

// HTTP 类型
export type RouteHandler = (...args: any[]) => any
export type NextFunction = (request?: any) => Promise<any>

// 通用工具类型
export type Awaitable<T> = T | Promise<T>
export type Optional<T, K extends keyof T> = Omit<T, K> & Partial<Pick<T, K>>
export type RequiredKeys<T> = {
  [K in keyof T]-?: {} extends Pick<T, K> ? never : K
}[keyof T]
```

### 2. 创建主入口文件

**文件**: `src/index.ts`

```typescript
// 导入 reflect-metadata（必须在最前面）
import 'reflect-metadata'

// 核心模块导出
export * from './core'
export * from './container'
export * from './routing'
export * from './middleware'
export * from './http'
export * from './config'

// 类型导出
export type {
  Constructor,
  ClassDecorator,
  MethodDecorator,
  ParameterDecorator,
  ServiceBinding,
  RouteHandler,
  NextFunction,
  Awaitable,
  Optional,
  RequiredKeys
} from './types'

// 版本信息
export const VERSION = '0.1.0'
```

### 3. 创建临时模块文件

**文件**: `src/core/index.ts`
```typescript
// 核心模块 - 稍后实现
export const CORE_MODULE = 'core'
```

**文件**: `src/container/index.ts`
```typescript
// 容器模块 - 稍后实现
export const CONTAINER_MODULE = 'container'
```

**文件**: `src/routing/index.ts`
```typescript
// 路由模块 - 稍后实现
export const ROUTING_MODULE = 'routing'
```

**文件**: `src/middleware/index.ts`
```typescript
// 中间件模块 - 稍后实现
export const MIDDLEWARE_MODULE = 'middleware'
```

**文件**: `src/http/index.ts`
```typescript
// HTTP模块 - 稍后实现
export const HTTP_MODULE = 'http'
```

**文件**: `src/config/index.ts`
```typescript
// 配置模块 - 稍后实现
export const CONFIG_MODULE = 'config'
```

## 完成标志
- [ ] 基础类型定义完成
- [ ] 主入口文件创建完成
- [ ] 临时模块文件创建完成
- [ ] TypeScript 类型检查无错误

## 下一步
完成此步骤后，继续执行 [01.3-testing-setup.md](./01.3-testing-setup.md)。 
