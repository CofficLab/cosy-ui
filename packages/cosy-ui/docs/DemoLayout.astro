---
import { getGroupedRoutes, createUrl } from './lib/route';
import { DocumentationLayout } from '@/index';
import type { SidebarSection, SidebarItem } from '@/components/layouts/DocumentationLayout.astro';

interface Props {
	title: string;
	showTOC?: boolean;
}

const { title, showTOC = true } = Astro.props;

// 从 URL 获取当前语言
const currentLocale = Astro.url.pathname.split('/')[2] || 'zh-cn';
const groupedRoutes = await getGroupedRoutes(currentLocale);

// 将路由转换为侧边栏项目格式
const sidebarItems: SidebarSection[] = groupedRoutes.map(group => ({
    title: group.group,
    items: group.routes.map(route => ({
        text: route.title,
        href: route.path
    }))
}));
---

<DocumentationLayout
	debug={false}
	title={title}
	siteName="Cosy UI"
	sidebarItems={sidebarItems}
	showTableOfContents={showTOC}
	showHeader={true}
	showFooter={true}
	footerSlogan="优雅、高效的 Astro 组件库"
	footerInspirationalSlogan="构建美好的用户界面"
	footerSocialLinks={[
		"https://github.com/CofficLab/cosy-ui"
	]}
	footerProducts={[
		{ name: "组件", href: createUrl("/components") },
		{ name: "布局", href: createUrl("/layouts") },
		{ name: "图标", href: createUrl("/components/icons") }
	]}
	footerAboutLink="https://coffic.zone.id/en/meta/about"
	footerContactLink="https://coffic.zone.id/en/meta/contact"
	footerBlogLink="https://coffic.zone.id/en/blogs"
	footerTermsLink="https://coffic.zone.id/en/meta/terms"
	footerPrivacyLink="https://coffic.zone.id/en/meta/privacy"
>
	<slot />
	
	<Fragment slot="head">
		<meta charset="UTF-8" />
		<meta name="description" content="Cosy UI - A beautiful Astro component library" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href={createUrl('/favicon.svg')} />
		<meta name="generator" content={Astro.generator} />
	</Fragment>
</DocumentationLayout>