---
/**
 * @component CardCourse
 *
 * @description
 * 课程卡片组件，用于展示课程信息，具有统一的设计风格。支持动态图标和渐变背景。
 *
 * @usage
 * ```astro
 * <CardCourse courseName="React 基础教程" lang="zh" href="/courses/react-basics" />
 * ```
 *
 * @props
 * - courseName: string - 课程标题
 * - description?: string - 课程描述
 * - lang: string - 语言（"en" 或 "zh"）
 * - href: string - 课程链接
 * - iconSize?: "sm" | "md" | "lg" | "xl" - 图标尺寸，默认为 "md"
 */

import '../../style.ts';
import AstroIcon from '../icons/AstroIcon.astro';
import {
  getCourseIcon,
  getCourseGradient,
  formatDisplayName,
  getIconSizeClasses,
} from './config';

interface Props {
  courseName: string;
  description?: string;
  lang: string;
  href: string;
  iconSize?: 'sm' | 'md' | 'lg' | 'xl';
}

const {
  courseName,
  description = '',
  lang,
  href,
  iconSize = 'md',
} = Astro.props;

// 获取对应的图标组件和背景渐变
const IconComponent = getCourseIcon(courseName);
const courseGradient = getCourseGradient(courseName);
const displayName = formatDisplayName(courseName);
const iconSizeClasses = getIconSizeClasses(iconSize);
---

<div
  class={`cosy:card cosy:shadow-lg hover:cosy:shadow-xl cosy:transition-all cosy:duration-300 hover:cosy:-translate-y-1 cosy:border-0 cosy:overflow-hidden cosy:bg-gradient-to-br ${courseGradient} cosy:relative`}>
  <!-- 背景图标 -->
  <div
    class={`cosy:absolute cosy:top-2 cosy:right-2 cosy:opacity-30 ${iconSizeClasses}`}>
    {
      IconComponent === AstroIcon ? (
        <IconComponent name="astro" class="cosy:w-full cosy:h-full" />
      ) : (
        <IconComponent class="cosy:w-full cosy:h-full" />
      )
    }
  </div>
  <div class="cosy:card-body cosy:p-6 cosy:relative cosy:z-10">
    <!-- 标题和描述区域 -->
    <div class="cosy:mb-4">
      <h3 class="cosy:text-lg cosy:font-semibold cosy:truncate cosy:text-start">
        {displayName}
      </h3>
      {
        description && (
          <p class="cosy:text-sm cosy:mt-4 cosy:line-clamp-3 cosy:text-start">
            {description}
          </p>
        )
      }
    </div>
    <!-- 操作按钮 -->
    <div class="cosy:card-actions cosy:justify-start cosy:mt-4">
      <a
        href={href}
        class="cosy:btn cosy:bg-base-100 cosy:backdrop-blur-sm cosy:border cosy:border-base-100/30 hover:cosy:bg-base-100/30 cosy:transition-all cosy:duration-300">
        {lang === 'en' ? 'Start Learning' : '开始学习'}
      </a>
    </div>
  </div>
</div>
