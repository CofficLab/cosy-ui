---
/**
 * Sidebar组件
 * 
 * 用于文档页面的侧边栏导航
 * 
 * @example
 * ```astro
 * ---
 * import Sidebar from './Sidebar.astro';
 * 
 * const sidebarItems = [
 *   { title: "入门", items: [
 *     { href: "/docs/getting-started", text: "快速开始" },
 *     { href: "/docs/installation", text: "安装" }
 *   ]}
 * ];
 * ---
 * 
 * <Sidebar sidebarItems={sidebarItems} currentPath="/docs/getting-started" />
 * ```
 */

import { isPathMatch } from '../../utils/path';
import "../../app.css"

export interface SidebarItem {
  href: string;
  text: string;
  items?: SidebarItem[];
}

export interface SidebarSection {
  title: string;
  items: SidebarItem[];
}

export interface Props {
  /**
   * 侧边栏项目
   */
  sidebarItems: SidebarSection[];
  
  /**
   * 当前路径
   */
  currentPath: string;
}

const { sidebarItems, currentPath } = Astro.props;
---

<aside class="w-64 border-r border-base-300 shrink-0">
  <nav class="p-4 sticky top-16">
    {sidebarItems.map((section: SidebarSection) => (
      <div class="mb-6">
        <h3 class="font-bold mb-2 text-base-content/70">{section.title}</h3>
        <ul class="menu bg-base-200 rounded-box w-56">
          {section.items.map((item: SidebarItem) => {
            const isActive = isPathMatch(currentPath, item.href);
            return (
              <li>
                <a 
                  href={item.href} 
                  class:list={[
                    "hover:bg-base-300",
                    { "menu-active": isActive }
                  ]}
                >
                  {item.text}
                </a>
                {item.items && (
                  <ul>
                    {item.items.map((subitem: SidebarItem) => {
                      const isSubActive = isPathMatch(currentPath, subitem.href);
                      return (
                        <li>
                          <a 
                            href={subitem.href} 
                            class:list={[
                              "hover:bg-base-300",
                              { "active": isSubActive }
                            ]}
                          >
                            {subitem.text}
                          </a>
                          {subitem.items && (
                            <ul>
                              {subitem.items.map((subsubitem: SidebarItem) => {
                                const isSubSubActive = isPathMatch(currentPath, subsubitem.href);
                                return (
                                  <li>
                                    <a 
                                      href={subsubitem.href} 
                                      class:list={[
                                        "hover:bg-base-300",
                                        { "active": isSubSubActive }
                                      ]}
                                    >
                                      {subsubitem.text}
                                    </a>
                                  </li>
                                );
                              })}
                            </ul>
                          )}
                        </li>
                      );
                    })}
                  </ul>
                )}
              </li>
            );
          })}
        </ul>
      </div>
    ))}
  </nav>
</aside> 