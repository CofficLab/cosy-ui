---
import { processSocialLink } from '../utils/social';
import Link from './Link.astro';
import Banner from './Banner.astro';
import SocialIcon from './SocialIcon.astro';

const {
	siteName,
	homeLink,
	slogan,
	company,
	copyright,
	inspirationalSlogan,
	icp,
	logo,
	products = [],
	aboutLink,
	contactLink,
	termsLink,
	privacyLink,
	socialLinks = [],
} = Astro.props;

const currentYear = new Date().getFullYear();

// 处理社交链接
const processedSocialLinks = socialLinks.map((link) => processSocialLink(link));
---

<footer class="bg-green-200/50 dark:bg-base-300/50 z-50 backdrop-blur-md">
	<div class="footer sm:footer-horizontal p-10 text-base-content">
		<aside class="flex flex-col items-center sm:items-start gap-2 place-self-center">
			<Link href={homeLink}>
				<div class="flex items-center gap-2 rounded-2xl">
					{
						logo && (
							<img
								src={logo.src}
								alt={logo.alt}
								class="h-6 w-6 fill-current rounded-2xl"
								width="32"
								height="32"
							/>
						)
					}
					<span class="text-xl font-bold">{siteName}</span>
				</div>
			</Link>
			<p class="text-sm opacity-70 self-center">{slogan}</p>

			<div class="flex gap-4 mt-4 sm:mt-0">
				{
					processedSocialLinks.map((link) => (
						<a
							href={link.url}
							target="_blank"
							rel="noopener noreferrer"
							class="btn btn-ghost btn-sm p-1 hover:text-primary"
							title={link.name}>
							<SocialIcon platform={link.platform} />
							<span class="sr-only">{link.name}</span>
						</a>
					))
				}
			</div>
		</aside>

		{
			products.length > 0 && (
				<nav class="place-self-center text-center flex flex-col items-center min-h-[200px]">
					<h6 class="footer-title">产品</h6>
					<div class="flex flex-col gap-2">
						{products.map((product) => (
							<Link href={product.href} external={product.external}>
								{product.name}
							</Link>
						))}
					</div>
				</nav>
			)
		}

		{
			(aboutLink || contactLink) && (
				<nav class="place-self-center text-center flex flex-col items-center min-h-[200px]">
					<h6 class="footer-title">关于</h6>
					<div class="flex flex-col gap-2">
						{aboutLink && <Link href={aboutLink}>关于我们</Link>}
						{contactLink && <Link href={contactLink}>联系我们</Link>}
					</div>
				</nav>
			)
		}

		{
			(termsLink || privacyLink) && (
				<nav class="place-self-center text-center flex flex-col items-center min-h-[200px]">
					<h6 class="footer-title">法律</h6>
					<div class="flex flex-col gap-2">
						{termsLink && <Link href={termsLink}>服务条款</Link>}
						{privacyLink && <Link href={privacyLink}>隐私政策</Link>}
					</div>
				</nav>
			)
		}
	</div>

	<Banner>
		{inspirationalSlogan}
	</Banner>

	<div class="flex flex-col sm:flex-col justify-center items-center p-4 text-sm opacity-70">
		<div class="flex items-center gap-2">
			<p>
				© {currentYear}
				{company} - {copyright}
			</p>
		</div>

		{
			icp && (
				<div class="text-center py-4">
					<p>{icp}</p>
				</div>
			)
		}
	</div>
</footer>
